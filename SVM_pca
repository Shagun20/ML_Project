{"cells":[{"cell_type":"code","execution_count":2,"metadata":{"id":"HbGr4XAwySJk","executionInfo":{"status":"ok","timestamp":1670184847333,"user_tz":-330,"elapsed":1071,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.svm import SVC\n","from sklearn import metrics\n","from sklearn.model_selection import train_test_split\n","from sklearn.model_selection import cross_validate\n","import matplotlib.pyplot as plt\n","%matplotlib inline"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"0wJrjyyezke3","executionInfo":{"status":"ok","timestamp":1670184853400,"user_tz":-330,"elapsed":3903,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["import csv\n","\n","url = 'https://drive.google.com/file/d/1aMf55MyERd7-M2U0HHsO2G2CDXJKmsce/view?usp=share_link'\n","file_id=url.split('/')[-2]\n","dwn_url='https://drive.google.com/uc?id=' + file_id\n","df = pd.read_csv(dwn_url)\n","df\n","df =df.loc[:, ~df.columns.str.contains('^Unnamed')]"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"190qFP4pEDKp","executionInfo":{"status":"ok","timestamp":1670184881748,"user_tz":-330,"elapsed":432,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["df = df.sample(frac=1)"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"3_wVi_3mz3wl","executionInfo":{"status":"ok","timestamp":1670184885946,"user_tz":-330,"elapsed":439,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["x = list(df.columns).index(\"RainTomorrow\")\n","ls= list(df.columns[:x])+list(df.columns[x+1:])\n","ls.append(\"RainTomorrow\")\n","df = df[ls]\n","df.head()\n","del x"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"QGg-8zaIz4hf","executionInfo":{"status":"ok","timestamp":1670184888029,"user_tz":-330,"elapsed":5,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["X=df[df.columns[:-1]]\n","y = df[df.columns[-1]]"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"BziYy7sw0vzh","executionInfo":{"status":"ok","timestamp":1670184892117,"user_tz":-330,"elapsed":646,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"_jVAd0FG2kbh","executionInfo":{"status":"ok","timestamp":1670184894238,"user_tz":-330,"elapsed":9,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["scaler = StandardScaler()\n","scaler.fit(X_train)\n","X_train = scaler.transform(X_train)\n","X_test = scaler.transform(X_test)"]},{"cell_type":"markdown","metadata":{"id":"1d3aNNPx2thq"},"source":["### Default parameters SVM"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"SUj0xUvB2qZN","executionInfo":{"status":"ok","timestamp":1670176501198,"user_tz":-330,"elapsed":53,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[],"source":["# svc=SVC() #Default hyperparameters\n","# svc.fit(X_train,y_train)\n","# y_pred=svc.predict(X_test)\n","# print('Accuracy Score:')\n","# print(metrics.accuracy_score(y_test,y_pred))\n","# print('Precision Score:')\n","# print(metrics.precision_score(y_test,y_pred))"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"XUlsxkDP59Un","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1670182403080,"user_tz":-330,"elapsed":5901933,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}},"outputId":"af79d4c0-05a5-4840-a94d-af85d5a69ba6"},"outputs":[{"output_type":"stream","name":"stdout","text":["SVM with 'linear' kernel has a mean precision of 0.766843089589121\n"]}],"source":["svc = SVC()\n","scores = cross_validate(svc, X, y, cv=10, scoring='precision')\n","print(f\"SVM with 'linear' kernel has a mean precision of {scores['test_score'].mean()}\")"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"w_tfFzfF6oQe","outputId":"7aaf57e3-2bab-4955-c2e5-4f6f0576d8fb","executionInfo":{"status":"ok","timestamp":1670191653520,"user_tz":-330,"elapsed":6755240,"user":{"displayName":"Shagun Mohta","userId":"16285843655690727916"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["SVM with 'rbf' kernel has a mean precision of 0.7667295883520395\n"]}],"source":["svc = SVC(kernel='rbf')\n","scores = cross_validate(svc, X, y, cv=10, scoring='precision')\n","print(f\"SVM with 'rbf' kernel has a mean precision of {scores['test_score'].mean()}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QHgxRuWeCtN4"},"outputs":[],"source":["C_range=list(range(1,20,2))\n","model_f1s=[]\n","model_precisions = []\n","for c in C_range:\n","    print(\"C = \", c)\n","    svc = SVC(kernel='linear', C=c)\n","    svc.fit(X_train,y_train)\n","    y_pred=svc.predict(X_test)\n","    print('F1 Score:', metrics.f1_score(y_test,y_pred))\n","    print('Precision Score:', metrics.precision_score(y_test,y_pred))\n","    model_f1s.append(metrics.f1_score(y_test,y_pred))\n","    model_precisions.append(metrics.precision_score(y_test,y_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IeFkDleGDAIy"},"outputs":[],"source":["# plt.xticks(np.arange(0,10))\n","plt.ylabel('Precision Scores')\n","plt.xlabel('Value of C for SVC')\n","plt.plot(C_range[:len(model_f1s)],model_f1s)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iqCyuCgFNKwh"},"outputs":[],"source":["svc = SVC(kernel=\"poly\")\n","scores = cross_validate(svc, X, y, cv=10, scoring='precision')\n","print(f\"SVM with 'poly' kernel has a mean precision of {scores['test_score'].mean()}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EoyYRfI6NKwh"},"outputs":[],"source":["svc = SVC(kernel=\"poly\")\n","scores = cross_validate(svc, X, y, cv=10, scoring='precision')\n","print(f\"SVM with 'poly' kernel has a mean precision of {scores['test_score'].mean()}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dBltC_cjNKwi"},"outputs":[],"source":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1mGznROptcJDWNvqLGv4xEufoh_BNujqr","timestamp":1670175732218}]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3.8.9 ('venv': venv)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.9"},"vscode":{"interpreter":{"hash":"51a4449d3a25570d9706dd2804d9f8c91eac2632bb5972378fc7154612b1a1ba"}}},"nbformat":4,"nbformat_minor":0}